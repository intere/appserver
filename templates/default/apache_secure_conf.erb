<VirtualHost _default_:443>
  SSLCertificateFile /etc/httpd/ssl/server.crt
  SSLCertificateKeyFile /etc/httpd/ssl/server.key
  SSLEngine on

  ServerAdmin ops@example.com
  DocumentRoot /vagrant/web/secure

  <Directory />
    Options Indexes FollowSymLinks MultiViews
    AllowOverride All
    Order allow,deny
    allow from all
  </Directory>

  ProxyPreserveHost On
  ProxyRequests Off
  AllowEncodedSlashes On

  # Jenkins
  <Proxy http://127.0.0.1:8081/jenkins*>
     Order allow,deny
     Allow from all
  </Proxy>

  ProxyPass /jenkins http://127.0.0.1:8081/jenkins nocanon
  ProxyPassReverse /jenkins http://127.0.0.1:8081/jenkins

  # Tomcat
  <Proxy http://127.0.0.1:8080/*>
     Order allow,deny
     Allow from all
  </Proxy>

  ProxyPass /api http://127.0.0.1:8080 nocanon
  ProxyPassReverse /api http://127.0.0.1:8080

  RequestHeader set X-Forwarded-Proto "https"
  RequestHeader set X-Forwarded-Port "443"

  ErrorLog /var/log/httpd/secure-error.log
  LogLevel warn
  CustomLog /var/log/httpd/secure-access.log combined
  ServerSignature On

</VirtualHost>
